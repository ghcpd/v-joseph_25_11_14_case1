FLOWDELTA DOCUMENTATION & TUTORIAL DEFECTS
============================================

CATEGORY 1: INCORRECT DOCUMENTATION
====================================

DEFECT 1.1: DeltaTracker - Wrong Parameter Names
-------------------------------------------------
Location: README.md (Quick Start section)
Issue: Parameter names do not match actual implementation

INCORRECT CODE (README):
```python
from flowdelta import DeltaTracker
tracker = DeltaTracker(source="orders", checkpoint="cp1")
last = tracker.get_last_timestamp()
```

ERROR TRACEBACK:
```
TypeError: DeltaTracker.__init__() got an unexpected keyword argument 'source'
```

ACTUAL IMPLEMENTATION (flowdelta/delta.py):
```python
class DeltaTracker:
    def __init__(self, source_name: str, checkpoint_id: str, *, initial_timestamp=None):
        self.source = source_name
        self.checkpoint = checkpoint_id
        self.initial = initial_timestamp

    def last_timestamp(self):
        return self.initial or "1970-01-01"
```

DEFECTS IDENTIFIED:
1. Parameter "source" should be "source_name"
2. Parameter "checkpoint" should be "checkpoint_id"
3. Method "get_last_timestamp()" does not exist - actual method is "last_timestamp()"

CORRECTED CODE:
```python
from flowdelta import DeltaTracker
tracker = DeltaTracker(source_name="orders", checkpoint_id="cp1")
last = tracker.last_timestamp()
print("Last timestamp:", last)
```


DEFECT 1.2: TaskScheduler - Wrong Parameter Names and No Default for max_runs
-------------------------------------------------------------------------------
Location: README.md (Creating a Scheduler section)
Issue: Parameter names do not match actual implementation

INCORRECT CODE (README):
```python
from flowdelta import TaskScheduler

def job_run():
    return "job complete"

sched = TaskScheduler(interval=5, on_tick=job_run)
sched.start()
```

ERROR TRACEBACK:
```
TypeError: TaskScheduler.__init__() got an unexpected keyword argument 'interval'
```

ACTUAL IMPLEMENTATION (flowdelta/scheduler.py):
```python
class TaskScheduler:
    def __init__(self, frequency: int, handler, *, max_runs=1):
        self.frequency = frequency
        self.handler = handler
        self.max_runs = max_runs

    def start(self):
        for _ in range(self.max_runs):
            self.handler()
            time.sleep(self.frequency)
```

DEFECTS IDENTIFIED:
1. Parameter "interval" should be "frequency"
2. Parameter "on_tick" should be "handler"
3. max_runs defaults to 1, causing the scheduler to only run once
4. Documentation should clarify the frequency unit (seconds)

CORRECTED CODE:
```python
from flowdelta import TaskScheduler

def job_run():
    return "job complete"

sched = TaskScheduler(frequency=5, handler=job_run, max_runs=3)
sched.start()
```


DEFECT 1.3: Storage - Wrong Method Names
-----------------------------------------
Location: README.md (Saving Data section)
Issue: Method names do not match actual implementation

INCORRECT CODE (README):
```python
from flowdelta import Storage

s = Storage("/tmp/flow")
s.save_json("users", {"a": 1})
print(s.load_json("users"))
```

ERROR TRACEBACK:
```
AttributeError: 'Storage' object has no attribute 'save_json'
```

ACTUAL IMPLEMENTATION (flowdelta/storage.py):
```python
class Storage:
    def __init__(self, path, *, mkdir=False):
        self.path = path
        if mkdir and not os.path.exists(path):
            os.makedirs(path)

    def write_json(self, key, data):
        fp = os.path.join(self.path, f"{key}.json")
        with open(fp, "w") as f:
            json.dump(data, f)

    def read_json(self, key):
        fp = os.path.join(self.path, f"{key}.json")
        with open(fp) as f:
            return json.load(f)
```

DEFECTS IDENTIFIED:
1. Method "save_json" should be "write_json"
2. Method "load_json" should be "read_json"
3. Storage constructor needs mkdir=True parameter to create path, but example doesn't include it
4. Path "/tmp/flow" may not be writable on all systems (especially Windows)

CORRECTED CODE:
```python
from flowdelta import Storage
import tempfile

# Use a temp directory for cross-platform compatibility
with tempfile.TemporaryDirectory() as tmpdir:
    s = Storage(tmpdir, mkdir=True)
    s.write_json("users", {"a": 1})
    print(s.read_json("users"))
```


DEFECT 1.4: run_delta - Wrong Parameter Name
----------------------------------------------
Location: README.md (Running a Delta section)
Issue: Parameter name does not match actual implementation

INCORRECT CODE (README):
```python
from flowdelta import run_delta

run_delta("orders", since="2020-01-01")
```

ERROR TRACEBACK:
```
TypeError: run_delta() got an unexpected keyword argument 'since'
```

ACTUAL IMPLEMENTATION (flowdelta/delta.py):
```python
def run_delta(source_name: str, since_timestamp: str, verbose: bool = False):
    if verbose:
        print(f"[delta] running {source_name} from {since_timestamp}")
    return {"status": "ok", "from": since_timestamp}
```

DEFECTS IDENTIFIED:
1. Parameter "since" should be "since_timestamp"
2. Function returns a dict but README doesn't show how to capture output
3. verbose parameter exists but is undocumented

CORRECTED CODE:
```python
from flowdelta import run_delta

result = run_delta("orders", since_timestamp="2020-01-01", verbose=True)
print(result)
```


CATEGORY 2: TUTORIAL EXAMPLES THAT DON'T RUN
=============================================

All four examples fail due to incorrect documentation. See Category 1 for details.

Each example:
1. Uses wrong parameter names
2. Calls wrong method names
3. Does not match actual function signatures

All issues are documented above and corrected examples are provided.


SUMMARY
=======
Total Defects Found: 4 major defects affecting all 4 README examples

Defect Types:
- Wrong parameter names: 5 instances
- Wrong method names: 2 instances
- Missing parameters: 1 instance
- Cross-platform issues: 1 instance

Impact: 100% of README examples are non-functional as written.
